{% extends "finance/base.html" %}

{% block title %}
    Main page
{% endblock %}

{% block main %}
    <div main>
        <div  tables>
           <table class = "table table-striped table-dark" align = "center">
                <h2>Financial Summary</h2>
                <tr>
                    <th>Expenses</th>
                    <th>Income</th>
                    <th>Cash-flow</th>
                    <th>Grand total</th>
                </tr>
                <tr>
                    <td>{{ expense_sum }}</td>
                    <td>{{ income_sum }}</td>
                    <td>{{ cash_flow }}</td>
                    <td>{{ user_cash }}</td>
                </tr>
                </table>
        </div>
        <div tables>
           <table class = "table table-striped table-dark" align = "center">
                <h2>Recurring Entries</h2>
                <tr>
                    <th>ID</th>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Amount</th>
                    <th>Time</th>
                    <th>Frequency</th>
                </tr>
                {% for entry in recurring_entries %}
                    <tr>
                        <td>{{ entry.id }}</td>
                        <td>{{ entry.value_type }}</td>
                        <td>{{ entry.title }}</td>
                        <td>{{ entry.amount }}</td>
                        <td>{{ entry.time }}</td>
                        <td>{{ entry.frequency }}</td>
                        <td><button class = "edit_auto btn btn-primary" data-my_id = "{{entry.id}}">Edit</button></td>
                        <td><button class = "delete_auto btn btn-primary" data-my_id = "{{entry.id}}">Delete</button></td>
                    </tr>
                {% endfor %}
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td><button class = "btn btn-primary" id = "delete_all_auto">Delete All</button></td>
                </tr>
              </table>
        </div>
       
        <form style = "display: none;" id = "edit_auto" name ="edit_auto" action = "/edit_auto/" method = "POST">            
            <h2>Edit Recurring Entry</h2>
            {% csrf_token %}
            <div class = "form-group" >
                <div id = "edit_id" name = "edit_id"></div>
            </div>
            <div class = "alert alert-danger" id = "editid"></div>
            <div class = "form-group">
                <p class = "lefties less">New type:</p>
                <select name = "edit_type" id = "edit_type" size = "2">
                    <option value = "Income">Income</option>
                    <option value = "Expense">Expense</option>
                </select>
                (optional)
            </div>
            <div class = "form-group">
                <p class = "lefties">New title:</p>
                <input type = "text" id = "edit_title" name = "edit_title" placeholder = "Title"></input>
                (optional)
            </div>
            <div class = "form-group">
                <p class = "lefties">New amount:</p>
                <input type = "number" min = "0" id = "edit_amount" name = "edit_amount" placeholder = "Amount" step = "any"></input>
                (optional)
            </div>
            <div class = "val_error" id = "editamount"></div>
            <div class = "form-group">
                <p class = "lefties less">New frequency:</p>
                <select id = "edit_frequency" name = edit_frequency size = "3">
                    <option value = "Daily">Daily</option>
                    <option value = "Weekly">Weekly</option>
                    <option value = "Monthly">Monthly</option>
                </select>
                (optional)
            </div>
            <button class="btn btn-primary" type="submit">Edit Recurring Entry</button>
        </form>

        <form id = "auto_values" name ="auto_values" action = "/auto_values/" method = "POST">
            <div class = "form-group">
                <h2 style = "padding-top: 10px;">Add Recurring Entry</h2>
                {% csrf_token %}
                <p class = "lefties less">Frequency:</p>
                <select required class = "form-control" name = "frequency" id = "frequency" size = "3">
                    <option id = "daily" name = "daily" value = "Daily">Daily</option>
                    <option id = "weekly" name = "weekly" value = "Weekly">Weekly</option>
                    <option id = "monthly" name = "monthly" value = "Monthly">Monthly</option>
                </select>
            </div>
            <div id = "freq" class = "val_error"></div>
            <div class = "form-group">
                <p class = "lefties less">Type:</p>                
                <select required class = "form-control" name = "auto_type" id = "auto_type" size = "2">
                    <option id = "auto_income" name = "auto_income" value = "Income">Income</option>
                    <option id = "auto_expense" name = "auto_expense" value = "Expense">Expense</option>
                </select>
            </div>
            <div id = "autotype" class = "val_error"></div>
            <div class = "form-group">
                <p class = "lefties">Title:</p>
                <input required class = "form-control" id = "auto_title" name = "auto_title" type = "text" placeholder = "Title">
                </input>                
            </div>
            <div class = "val_error" id = "autotitle"></div>
            <div class = "form-group">
                <p class = "lefties">Amount:</p>
                <input required class = "form-control" id = "auto_amount" name = "auto_amount" type = "number" min = "0" step = "any" placeholder = "Amount">
                </input>                
            </div>
            <div id = "autoamount" class = "val_error"></div>
            <button class="btn btn-primary" type="submit">Add recurring element</button>
        </form>
    </div>
{% endblock %}